<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HealthSentinel - Water Quality Monitoring</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
<style>
:root{--bg:#f7fbf8;--nav-start:#2b7a78;--nav-end:#023e8a;--accent:#ffb703;--card:#fff;--muted:#3a3a3a;--success:#2d6a4f;--danger:#d32f2f;--warning:#ff9800;--shadow:rgba(11,22,36,0.08);}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--muted);line-height:1.35;scroll-behavior:smooth;}
nav{position:sticky;top:0;z-index:1200;display:flex;align-items:center;gap:20px;padding:12px 18px;background:linear-gradient(90deg,var(--nav-start),var(--nav-end));color:#fff;flex-wrap:wrap;box-shadow:0 3px 12px rgba(2,30,68,0.12);}
.nav-left{display:flex;gap:18px;align-items:center;}
.nav-left a{color:#fff;text-decoration:none;font-weight:700;font-family:'Montserrat',sans-serif;font-size:15px;padding:6px 8px;border-radius:6px;}
.nav-left a:hover{background: rgba(255,255,255,0.06);}
.tools{margin-left:auto;display:flex;gap:8px;align-items:center;}
.settings-btn{background: rgba(255,255,255,0.12);color:#fff;border:none;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:8px;}
.lang-dropdown{position:relative;display:inline-block;}
.lang-select{background: rgba(255,255,255,0.12);color:#fff;border:none;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:120px;}
.lang-options{display:none;position:absolute;top:100%;right:0;background:#fff;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,0.15);min-width:180px;z-index:1300;margin-top:4px;}
.lang-options.show{display:block;}
.lang-option{display:flex;align-items:center;gap:8px;padding:10px 12px;color:var(--muted);cursor:pointer;border-bottom:1px solid #f0f0f0;}
.lang-option:hover{background:#f8f9fa;}
main{max-width:1200px;margin:18px auto;padding:12px;}
.hero{background: linear-gradient(135deg,#e1f5fe 0%, #f3e5f5 100%);border-radius:14px;padding:28px;display:flex;gap:18px;align-items:center;box-shadow: 0 10px 30px var(--shadow);margin-bottom:18px;}
.hero .left{flex:1;}
.brand{font-family:'Montserrat',sans-serif;font-weight:900;color:var(--nav-end);font-size:32px;margin:0 0 6px 0;}
.subtitle{font-size:16px;color:var(--muted);margin:0 0 12px 0;}
.hero p{margin:0;color:#2f4858;font-weight:600;font-size:14.5px;}
.section-title{font-family:'Montserrat',sans-serif;font-weight:900;color:var(--nav-end);margin:8px 0 18px 0;font-size:20px;}
.sensors-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:20px 0;}
.sensor-card{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 8px 20px rgba(8,30,45,0.06);transition:transform 0.2s;}
.sensor-card:hover{transform:translateY(-2px);}
.sensor-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.sensor-name{font-weight:700;color:var(--nav-end);font-size:18px;}
.sensor-status{padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600;}
.status-safe{background:#d4edda;color:#155724;}
.status-warning{background:#fff3cd;color:#856404;}
.status-danger{background:#f8d7da;color:#721c24;}
.status-offline{background:#e2e3e5;color:#495057;}
.sensor-location{color:#666;font-size:14px;margin-bottom:16px;}
.metrics-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;}
.metric{text-align:center;padding:12px;background:#f8f9fa;border-radius:8px;}
.metric-value{font-size:20px;font-weight:700;margin-bottom:4px;}
.metric-label{font-size:12px;color:#666;}
.ph-safe{color:var(--success);}
.ph-warning{color:var(--warning);}
.ph-danger{color:var(--danger);}
.last-updated{font-size:12px;color:#888;text-align:center;}
.alert-panel{background:linear-gradient(135deg,#fff3cd,#f8d7da);border-radius:12px;padding:20px;margin-bottom:20px;border-left:5px solid var(--warning);}
.alert-title{font-weight:700;color:var(--danger);margin-bottom:8px;display:flex;align-items:center;gap:8px;}
.alert-desc{color:#856404;margin:0;}
.water-map{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 8px 20px rgba(8,30,45,0.06);margin:20px 0;text-align:center;}
.map-placeholder{background:linear-gradient(135deg,#e3f2fd,#f3e5f5);height:300px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:var(--muted);font-size:18px;}
.controls{display:flex;gap:12px;margin:20px 0;flex-wrap:wrap;}
.control-btn{padding:8px 16px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all 0.3s;}
.control-btn.primary{background:var(--nav-end);color:#fff;}
.control-btn.secondary{background:#e9ecef;color:var(--muted);}
.control-btn:hover{opacity:0.8;}
.trends-chart{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 8px 20px rgba(8,30,45,0.06);margin:20px 0;}
.chart-placeholder{height:200px;background:#f8f9fa;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#666;}
@media (max-width:768px){.sensors-grid{grid-template-columns:1fr;}.controls{justify-content:center;}.hero{flex-direction:column;align-items:flex-start;}}
</style>
</head>
<body>

<nav>
  <div class="nav-left">
    <a href="index.html">🏠 Home</a>
    <a href="index.html#alerts">🚨 Alerts</a>
  </div>
  <div class="tools">
    <div class="lang-dropdown">
      <button class="lang-select" id="langSelect">
        <span class="lang-flag">🇮🇳</span>
        <span id="selectedLang">English</span>
        <span>▼</span>
      </button>
      <div class="lang-options" id="langOptions">
        <div class="lang-option" data-lang="en-IN"><span class="lang-flag">🇮🇳</span><span>English (India)</span></div>
        <div class="lang-option" data-lang="hi-IN"><span class="lang-flag">🇮🇳</span><span>हिंदी (Hindi)</span></div>
        <div class="lang-option" data-lang="ta-IN"><span class="lang-flag">🇮🇳</span><span>தமிழ் (Tamil)</span></div>
        <div class="lang-option" data-lang="as-IN"><span class="lang-flag">🇮🇳</span><span>অসমীয়া (Assamese)</span></div>
        <div class="lang-option" data-lang="bn-IN"><span class="lang-flag">🇮🇳</span><span>বাংলা (Bengali)</span></div>
      </div>
    </div>
    <button class="settings-btn" id="settingsBtn">⚙️ Settings</button>
  </div>
</nav>

<main>
  <section class="hero">
    <div class="left">
      <h1 class="brand" data-text="brand">HealthSentinel</h1>
      <p class="subtitle" data-text="wq_subtitle">Water Quality Monitoring</p>
      <p data-text="wq_hero_desc">Real-time monitoring of water sources using IoT sensors. Get instant alerts when water quality becomes unsafe.</p>
    </div>
    <div style="width:220px;text-align:center;">
      <div style="font-size:64px;margin-bottom:10px;">🌊</div>
      <div style="font-weight:700;color:var(--success)" data-text="wq_trust">Real-time • Accurate • Automated</div>
    </div>
  </section>

  <section>
    <!-- Alert Panel -->
    <div class="alert-panel" id="alertPanel" style="display:none;">
      <div class="alert-title">⚠️ <span data-text="wq_alert_title">Water Quality Alert</span></div>
      <p class="alert-desc" id="alertDescription" data-text="wq_alert_desc">High contamination detected in Village A well. Avoid drinking from this source.</p>
    </div>

    <div class="controls">
      <button class="control-btn primary" onclick="refreshData()" data-text="wq_refresh">🔄 Refresh Data</button>
      <button class="control-btn secondary" onclick="showHistory()" data-text="wq_history">📊 View History</button>
      <button class="control-btn secondary" onclick="downloadReport()" data-text="wq_download">📥 Download Report</button>
    </div>

    <h2 class="section-title" data-text="wq_sensor_network">🔍 Sensor Network Status</h2>
    <div class="sensors-grid" id="sensorsGrid">
      <!-- Sensors will be populated by JavaScript -->
    </div>

    <!-- Water Sources Map -->
    <div class="water-map">
      <h2 class="section-title" data-text="wq_sources_map">🗺️ Water Sources Map</h2>
      <div class="map-placeholder" data-text="wq_map_placeholder">
        🗺️ Interactive map showing water sensor locations<br>
        (In production: Google Maps integration with sensor markers)
      </div>
    </div>

    <!-- Trends Chart -->
    <div class="trends-chart">
      <h2 class="section-title" data-text="wq_trends">📈 Water Quality Trends</h2>
      <div class="chart-placeholder" data-text="wq_chart_placeholder">
        📊 pH and TDS trends over the last 7 days<br>
        (In production: Chart.js integration)
      </div>
    </div>
  </section>
</main>

<script>
// Water Quality Monitoring System
let sensors = [];
let isSimulating = true;

// Language system
const texts = {
  "en-IN": {
    brand: "HealthSentinel",
    wq_subtitle: "Water Quality Monitoring",
    wq_hero_desc: "Real-time monitoring of water sources using IoT sensors. Get instant alerts when water quality becomes unsafe.",
    wq_trust: "Real-time • Accurate • Automated",
    wq_alert_title: "Water Quality Alert",
    wq_alert_desc: "High contamination detected in Village A well. Avoid drinking from this source.",
    wq_refresh: "🔄 Refresh Data",
    wq_history: "📊 View History",
    wq_download: "📥 Download Report",
    wq_sensor_network: "🔍 Sensor Network Status",
    wq_sources_map: "🗺️ Water Sources Map",
    wq_map_placeholder: "🗺️ Interactive map showing water sensor locations\\n(In production: Google Maps integration with sensor markers)",
    wq_trends: "📈 Water Quality Trends",
    wq_chart_placeholder: "📊 pH and TDS trends over the last 7 days\\n(In production: Chart.js integration)",
    wq_ph: "pH Level",
    wq_tds: "TDS (ppm)",
    wq_turbidity: "Turbidity",
    wq_bacteria: "Bacteria Count",
    wq_last_updated: "Last updated",
    wq_safe: "Safe",
    wq_warning: "Warning",
    wq_danger: "Danger",
    wq_offline: "Offline"
  },
  "hi-IN": {
    brand: "हेल्थसेंटिनल",
    wq_subtitle: "जल गुणवत्ता निगरानी",
    wq_hero_desc: "IoT सेंसर का उपयोग करके जल स्रोतों की वास्तविक समय निगरानी। जब पानी की गुणवत्ता असुरक्षित हो जाए तो तुरंत अलर्ट प्राप्त करें।",
    wq_trust: "वास्तविक समय • सटीक • स्वचालित",
    wq_alert_title: "जल गुणवत्ता चेतावनी",
    wq_alert_desc: "गांव ए के कुएं में उच्च संदूषण का पता चला है। इस स्रोत से पानी पीने से बचें।",
    wq_refresh: "🔄 डेटा रिफ्रेश करें",
    wq_history: "📊 इतिहास देखें",
    wq_download: "📥 रिपोर्ट डाउनलोड करें",
    wq_sensor_network: "🔍 सेंसर नेटवर्क स्थिति",
    wq_sources_map: "🗺️ जल स्रोत मानचित्र",
    wq_map_placeholder: "🗺️ जल सेंसर स्थानों को दिखाने वाला इंटरैक्टिव मानचित्र\\n(उत्पादन में: सेंसर मार्कर के साथ Google मानचित्र एकीकरण)",
    wq_trends: "📈 जल गुणवत्ता रुझान",
    wq_chart_placeholder: "📊 पिछले 7 दिनों में pH और TDS रुझान\\n(उत्पादन में: Chart.js एकीकरण)",
    wq_ph: "pH स्तर",
    wq_tds: "TDS (ppm)",
    wq_turbidity: "टर्बिडिटी",
    wq_bacteria: "बैक्टीरिया संख्या",
    wq_last_updated: "अंतिम अपडेट",
    wq_safe: "सुरक्षित",
    wq_warning: "चेतावनी",
    wq_danger: "खतरा",
    wq_offline: "ऑफलाइन"
  },
  "ta-IN": {
    brand: "ஹெல்த்செண்டிநல்",
    wq_subtitle: "நீர் தர கண்காணிப்பு",
    wq_hero_desc: "IoT சென்சர்களை பயன்படுத்தி நீர் மூலங்களின் உடனடி கால கண்காணிப்பு. நீரின் தரம் பாதுகாப்பற்றதாக ஆகும்போது தற்கால எச்சரிக்கைகளை பெறவும்.",
    wq_trust: "உடனடி காலம் • தீர்மானமான • தானியங்கி",
    wq_alert_title: "நீர் தர எச்சரிக்கை",
    wq_alert_desc: "கிராமம் அ கிணற்றில் அதிக மலிநீகரணம் கண்டறியப்பட்டு. இந்த மூலத்திலிருந்து நீர் குடிப்பதை தவிர்க்கவும்.",
    wq_refresh: "🔄 தரவை புதுப்பிக்கவும்",
    wq_history: "📊 வரலாறு பார்க்கவும்",
    wq_download: "📥 அறிக்கை பதிவிறக்கவும்",
    wq_sensor_network: "🔍 சென்சர் நெட்வர்க் நிலை",
    wq_sources_map: "🗺️ நீர் மூலங்கள் வகைப்பாடு",
    wq_map_placeholder: "🗺️ நீர் சென்சர் இடங்களை காட்டும் இணையாக வகைப்பாடு\\n(உற்பத்தியில்: சென்சர் குறிகளுடன் Google வகைப்பாடு இணைப்பு)",
    wq_trends: "📈 நீர் தர செயல்பாடு வழிமுறைகள்",
    wq_chart_placeholder: "📊 கடந்த 7 நாட்களில் pH மற்றும் TDS வழிமுறைகள்\\n(உற்பத்தியில்: Chart.js இணைப்பு)",
    wq_ph: "pH நிலை",
    wq_tds: "TDS (ppm)",
    wq_turbidity: "மூக்கத்தன்மை",
    wq_bacteria: "பேக்டீரியா எண்ணிக்கை",
    wq_last_updated: "அண்மையாக புதுப்பிக்கப்பட்டது",
    wq_safe: "பாதுகாப்பான",
    wq_warning: "எச்சரிக்கை",
    wq_danger: "ஆபத்து",
    wq_offline: "ஆஃப்லைன்"
  },
  "as-IN": {
    brand: "হেল্থসেণ্টিনেল",
    wq_subtitle: "পানীৰ গুণাগুণ নিৰীক্ষণ",
    wq_hero_desc: "IoT চেন্সৰ ব্যৱহাৰ কৰি পানীৰ উৎসসমূহৰ ৰিয়েল-টাইম নিৰীক্ষণ। পানীৰ গুণাগুণ বিপজ্জনক হৈ উঠিলে তৎক্ষণাৎ সতৰ্কবাণী পাওক।",
    wq_trust: "ৰিয়েল-টাইম • সঠিক • স্বচালিত",
    wq_alert_title: "পানীৰ গুণাগুণ সতৰ্কবাণী",
    wq_alert_desc: "গাঁও এৰ কুঁৱাত উচ্চ দূষণ ধৰা পৰিছে। এই উৎসৰ পৰা পানী খোৱা নকৰিব।",
    wq_refresh: "🔄 ডেটা সতেজ কৰক",
    wq_history: "📊 ইতিহাস চাওক",
    wq_download: "📥 প্ৰতিবেদন ডাউনলোড কৰক",
    wq_sensor_network: "🔍 চেন্সৰ নেটৱৰ্ক স্থিতি",
    wq_sources_map: "🗺️ পানীৰ উৎস মানচিত্ৰ",
    wq_map_placeholder: "🗺️ পানী চেন্সৰৰ স্থান দেখুৱা ইন্টাৰঅ্যাক্টিভ মানচিত্ৰ\\n(উৎপাদনত: চেন্সৰ মাৰ্কাৰৰ সৈতে Google মানচিত্ৰ একীকৰণ)",
    wq_trends: "📈 পানীৰ গুণাগুণ ধাৰা",
    wq_chart_placeholder: "📊 যোৱা 7 দিনত pH আৰু TDS ধাৰা\\n(উৎপাদনত: Chart.js একীকৰণ)",
    wq_ph: "pH স্তৰ",
    wq_tds: "TDS (ppm)",
    wq_turbidity: "টাৰ্বিডিটি",
    wq_bacteria: "ব্যাক্টেৰিয়াৰ সংখ্যা",
    wq_last_updated: "শেষ আপডেট",
    wq_safe: "সুৰক্ষিত",
    wq_warning: "সতৰ্কবাণী",
    wq_danger: "বিপদ",
    wq_offline: "অফলাইন"
  },
  "bn-IN": {
    brand: "হেল্থসেন্টিনেল",
    wq_subtitle: "জল গুণমান মনিটরিং",
    wq_hero_desc: "IoT সেন্সর ব্যবহার করে জলের উৎসগুলির রিয়েল-টাইম মনিটরিং। জলের গুণমান অনিরাপদ হয়ে উঠলে তাৎক্ষণিক সতর্কতা পান।",
    wq_trust: "রিয়েল-টাইম • নির্ভুল • স্বয়ংক্রিয়",
    wq_alert_title: "জল গুণমান সতর্কতা",
    wq_alert_desc: "গ্রাম এ-এর কুয়োতে উচ্চ দূষণ শনাক্ত হয়েছে। এই উৎস থেকে জল পান এড়িয়ে চলুন।",
    wq_refresh: "🔄 ডেটা রিফ্রেশ করুন",
    wq_history: "📊 ইতিহাস দেখুন",
    wq_download: "📥 রিপোর্ট ডাউনলোড করুন",
    wq_sensor_network: "🔍 সেন্সর নেটওয়ার্ক স্থিতি",
    wq_sources_map: "🗺️ জলের উৎস মানচিত্র",
    wq_map_placeholder: "🗺️ জল সেন্সরের অবস্থান দেখানো ইন্টারঅ্যাক্টিভ মানচিত্র\\n(উৎপাদনে: সেন্সর মার্কার সহ Google মানচিত্র ইন্টিগ্রেশন)",
    wq_trends: "📈 জল গুণমানের প্রবণতা",
    wq_chart_placeholder: "📊 গত 7 দিনের pH এবং TDS প্রবণতা\\n(উৎপাদনে: Chart.js ইন্টিগ্রেশন)",
    wq_ph: "pH স্তর",
    wq_tds: "TDS (ppm)",
    wq_turbidity: "টার্বিডিটি",
    wq_bacteria: "ব্যাকটেরিয়ার সংখ্যা",
    wq_last_updated: "সর্বশেষ আপডেট",
    wq_safe: "নিরাপদ",
    wq_warning: "সতর্কতা",
    wq_danger: "বিপদ",
    wq_offline: "অফলাইন"
  }
};

function updateLanguage(lang) {
  document.querySelectorAll('[data-text]').forEach(element => {
    const textKey = element.getAttribute('data-text');
    if (texts[lang] && texts[lang][textKey]) {
      element.textContent = texts[lang][textKey];
    }
  });
  const langNames = {'en-IN': 'English', 'hi-IN': 'हिंदी', 'ta-IN': 'தமிழ்', 'as-IN': 'অসমীয়া', 'bn-IN': 'বাংলা'};
  document.getElementById('selectedLang').textContent = langNames[lang];
  localStorage.setItem('selectedLang', lang);
}

// Sensor data simulation
function generateSensorData() {
  const locations = ['Village A Well', 'Village B Pond', 'Community Tank', 'River Source', 'Tube Well #1', 'Tube Well #2'];
  
  sensors = locations.map((location, index) => {
    const ph = parseFloat((Math.random() * 4 + 5.5).toFixed(1)); // 5.5-9.5
    const tds = Math.floor(Math.random() * 800 + 50); // 50-850
    const turbidity = parseFloat((Math.random() * 10).toFixed(1)); // 0-10
    const bacteria = Math.floor(Math.random() * 150); // 0-150
    const isOnline = Math.random() > 0.1; // 90% online
    
    let status = 'safe';
    if (!isOnline) {
      status = 'offline';
    } else if (ph < 6.5 || ph > 8.5 || tds > 500 || bacteria > 50 || turbidity > 5) {
      status = 'danger';
    } else if (ph < 7 || ph > 8.2 || tds > 300 || bacteria > 20 || turbidity > 2) {
      status = 'warning';
    }
    
    return {
      id: `WS${String(index + 1).padStart(3, '0')}`,
      location: location,
      ph: ph,
      tds: tds,
      turbidity: turbidity,
      bacteria: bacteria,
      status: status,
      isOnline: isOnline,
      lastUpdated: new Date(Date.now() - Math.random() * 1800000) // Random time within last 30 min
    };
  });
}

function renderSensors() {
  const grid = document.getElementById('sensorsGrid');
  const currentLang = localStorage.getItem('selectedLang') || 'en-IN';
  
  grid.innerHTML = sensors.map(sensor => `
    <div class="sensor-card">
      <div class="sensor-header">
        <div class="sensor-name">${sensor.id} - ${sensor.location}</div>
        <div class="sensor-status status-${sensor.status}">${texts[currentLang][`wq_${sensor.status}`] || sensor.status}</div>
      </div>
      <div class="sensor-location">📍 ${sensor.location}</div>
      
      <div class="metrics-grid">
        <div class="metric">
          <div class="metric-value ph-${sensor.ph < 6.5 || sensor.ph > 8.5 ? 'danger' : sensor.ph < 7 || sensor.ph > 8.2 ? 'warning' : 'safe'}">${sensor.isOnline ? sensor.ph : '--'}</div>
          <div class="metric-label">${texts[currentLang]['wq_ph'] || 'pH Level'}</div>
        </div>
        <div class="metric">
          <div class="metric-value ph-${sensor.tds > 500 ? 'danger' : sensor.tds > 300 ? 'warning' : 'safe'}">${sensor.isOnline ? sensor.tds : '--'}</div>
          <div class="metric-label">${texts[currentLang]['wq_tds'] || 'TDS (ppm)'}</div>
        </div>
        <div class="metric">
          <div class="metric-value ph-${sensor.turbidity > 5 ? 'danger' : sensor.turbidity > 2 ? 'warning' : 'safe'}">${sensor.isOnline ? sensor.turbidity : '--'}</div>
          <div class="metric-label">${texts[currentLang]['wq_turbidity'] || 'Turbidity'}</div>
        </div>
        <div class="metric">
          <div class="metric-value ph-${sensor.bacteria > 50 ? 'danger' : sensor.bacteria > 20 ? 'warning' : 'safe'}">${sensor.isOnline ? sensor.bacteria : '--'}</div>
          <div class="metric-label">${texts[currentLang]['wq_bacteria'] || 'Bacteria Count'}</div>
        </div>
      </div>
      
      <div class="last-updated">${texts[currentLang]['wq_last_updated'] || 'Last updated'}: ${sensor.isOnline ? sensor.lastUpdated.toLocaleTimeString() : 'N/A'}</div>
    </div>
  `).join('');
  
  // Show alert if any sensor is in danger
  const dangerSensors = sensors.filter(s => s.status === 'danger');
  if (dangerSensors.length > 0) {
    document.getElementById('alertPanel').style.display = 'block';
    document.getElementById('alertDescription').textContent = 
      `High contamination detected in ${dangerSensors[0].location}. Avoid drinking from this source.`;
  } else {
    document.getElementById('alertPanel').style.display = 'none';
  }
}

function refreshData() {
  if (isSimulating) {
    generateSensorData();
    renderSensors();
    showNotification('Data refreshed successfully! 📊');
  } else {
    // In production: fetch real sensor data from API
    fetch('/api/water-quality/')
      .then(response => response.json())
      .then(data => {
        sensors = data.sensors;
        renderSensors();
      })
      .catch(error => {
        console.error('Error fetching sensor data:', error);
        showNotification('Error refreshing data. Please try again. ❌');
      });
  }
}

function showHistory() {
  alert('📊 Historical data viewer would open here.\\n\\nFeatures:\\n- 7-day trends\\n- Monthly reports\\n- Contamination events\\n- Seasonal patterns');
}

function downloadReport() {
  // Simulate report generation
  const reportData = {
    timestamp: new Date().toISOString(),
    sensors: sensors.map(s => ({
      id: s.id,
      location: s.location,
      status: s.status,
      ph: s.ph,
      tds: s.tds,
      turbidity: s.turbidity,
      bacteria: s.bacteria
    }))
  };
  
  const blob = new Blob([JSON.stringify(reportData, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `water-quality-report-${new Date().toISOString().split('T')[0]}.json`;
  a.click();
  URL.revokeObjectURL(url);
  
  showNotification('Report downloaded successfully! 📥');
}

function showNotification(message) {
  // Simple notification system
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--success);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    z-index: 2000;
    font-weight: 600;
  `;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, 3000);
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
  const savedLang = localStorage.getItem('selectedLang') || 'en-IN';
  updateLanguage(savedLang);
  
  // Language dropdown
  const langSelect = document.getElementById('langSelect');
  const langOptions = document.getElementById('langOptions');
  
  langSelect.addEventListener('click', function(e) {
    e.stopPropagation();
    langOptions.classList.toggle('show');
  });
  
  document.addEventListener('click', function() {
    langOptions.classList.remove('show');
  });
  
  document.querySelectorAll('.lang-option').forEach(option => {
    option.addEventListener('click', function() {
      const selectedLang = this.dataset.lang;
      updateLanguage(selectedLang);
      langOptions.classList.remove('show');
      renderSensors(); // Re-render with new language
    });
  });
  
  // Settings button
  document.getElementById('settingsBtn').addEventListener('click', function() {
    alert('Settings panel would open here');
  });
  
  // Initial data load
  generateSensorData();
  renderSensors();
  
  // Auto-refresh every 30 seconds
  setInterval(() => {
    if (isSimulating) {
      refreshData();
    }
  }, 30000);
});
</script>

</body>
</html>